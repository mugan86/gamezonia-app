function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),e}function _createSuper(e){return function(){var t,r=_getPrototypeOf(e);if(_isNativeReflectConstruct()){var n=_getPrototypeOf(this).constructor;t=Reflect.construct(r,arguments,n)}else t=r.apply(this,arguments);return _possibleConstructorReturn(this,t)}}function _possibleConstructorReturn(e,t){return!t||"object"!=typeof t&&"function"!=typeof t?_assertThisInitialized(e):t}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}(window.webpackJsonp=window.webpackJsonp||[]).push([[12],{gAmC:function(e,t,r){"use strict";r.r(t),r.d(t,"UsersModule",(function(){return S}));var n,a,i,o,s=r("ofXK"),c=r("tyNb"),u=r("mrSG"),l=r("ODCe"),f=r("b1el"),p=r("0iDv"),b=r("sYSY"),d=r("PjjI"),v=r("fXoL"),m=r("0nJ8"),h=r("UdEE"),y=r("q3Kh"),k=r("vqVJ"),g=r("/IUn"),O=((n=function(e){_inherits(r,e);var t=_createSuper(r);function r(e,n){var a;return _classCallCheck(this,r),(a=t.call(this,n)).usersService=e,a}return _createClass(r,[{key:"register",value:function(e){return this.usersService.register(e)}},{key:"update",value:function(e){return this.set(h.e,{user:e,include:!1}).pipe(Object(y.map)((function(e){return e.updateUser})))}},{key:"unblock",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return this.set(h.c,{id:e,unblock:t,admin:r}).pipe(Object(y.map)((function(e){return e.blockUser})))}},{key:"sendEmailActive",value:function(e,t){return this.set(h.a,{id:e,email:t}).pipe(Object(y.map)((function(e){return e.activeUserEmail})))}}]),r}(m.a)).\u0275fac=function(e){return new(e||n)(v.Zb(k.a),v.Zb(g.a))},n.\u0275prov=v.Ib({token:n,factory:n.\u0275fac,providedIn:"root"}),n),C=r("hrBI"),_=[{path:"",component:(a=function(){function e(t){_classCallCheck(this,e),this.service=t,this.query=l.c,this.filterActiveValues=d.a.ACTIVE}return _createClass(e,[{key:"ngOnInit",value:function(){this.context={},this.itemsPage=10,this.resultData={listKey:"users",definitionKey:"users"},this.include=!0,this.columns=[{property:"id",label:"#"},{property:"name",label:"Nombre"},{property:"lastname",label:"Apellidos"},{property:"email",label:"Correo electr\xf3nico"},{property:"role",label:"Permisos"},{property:"active",label:"\xbfActivo?"}]}},{key:"initializeForm",value:function(e){var t=void 0!==e.name&&""!==e.name?e.name:"",r=void 0!==e.lastname&&""!==e.lastname?e.lastname:"",n=void 0!==e.email&&""!==e.email?e.email:"",a=new Array(2);return a[0]=void 0!==e.role&&"ADMIN"===e.role?"selected":"",a[1]=void 0!==e.role&&"CLIENT"===e.role?"selected":"",'\n      <input id="name" value="'.concat(t,'" class="swal2-input" placeholder="Nombre" required>\n      <input id="lastname" value="').concat(r,'" class="swal2-input" placeholder="Apellidos" required>\n      <input id="email" value="').concat(n,'" class="swal2-input" placeholder="Correo Electr\xf3nico" required>\n      <select id="role" class="swal2-input">\n        <option value="ADMIN" ').concat(a[0],'>Administrador</option>\n        <option value="CLIENT" ').concat(a[1],">Cliente</option>\n      </select>\n    ")}},{key:"takeAction",value:function(e){return Object(u.b)(this,void 0,void 0,regeneratorRuntime.mark((function t(){var r,n,a,i;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:r=e[0],n=e[1],a=this.initializeForm(n),t.t0=r,t.next="add"===t.t0?4:"edit"===t.t0?6:"info"===t.t0?8:"block"===t.t0?13:"unblock"===t.t0?15:16;break;case 4:return this.addForm(a),t.abrupt("break",16);case 6:return this.updateForm(a,n),t.abrupt("break",16);case 8:return t.next=10,Object(f.e)("Detalles","".concat(n.name," ").concat(n.lastname,'<br/>\n          <i class="fas fa-envelope-open-text"></i>&nbsp;&nbsp;').concat(n.email),!1!==n.active?375:400,'<i class="fas fa-edit"></i> Editar',!1!==n.active?'<i class="fas fa-lock"></i> Bloquear':'<i class="fas fa-lock-open"></i> Desbloquear');case 10:return(i=t.sent)?this.updateForm(a,n):!1===i&&this.unblockForm(n,!1===n.active),t.abrupt("break",16);case 13:return this.unblockForm(n,!1),t.abrupt("break",16);case 15:this.unblockForm(n,!0);case 16:case"end":return t.stop()}}),t,this)})))}},{key:"addForm",value:function(e){return Object(u.b)(this,void 0,void 0,regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(f.f)("A\xf1adir usuario",e);case 2:r=t.sent,this.addUser(r);case 4:case"end":return t.stop()}}),t,this)})))}},{key:"addUser",value:function(e){var t=this;if(e.value){var r=e.value;r.password="1234",r.active=!1,this.service.register(r).subscribe((function(e){if(e.status)return Object(p.a)(b.a.SUCCESS,e.message),void t.service.sendEmailActive(e.user.id,r.email).subscribe((function(e){e.status?Object(p.a)(b.a.SUCCESS,e.message):Object(p.a)(b.a.WARNING,e.message)}));Object(p.a)(b.a.WARNING,e.message)}))}}},{key:"updateForm",value:function(e,t){return Object(u.b)(this,void 0,void 0,regeneratorRuntime.mark((function r(){var n;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,Object(f.f)("Modificar usuario",e);case 2:n=r.sent,this.updateUser(n,t.id);case 4:case"end":return r.stop()}}),r,this)})))}},{key:"updateUser",value:function(e,t){e.value&&(e.value.id=t,this.service.update(e.value).subscribe((function(e){e.status?Object(p.a)(b.a.SUCCESS,e.message):Object(p.a)(b.a.WARNING,e.message)})))}},{key:"unblockForm",value:function(e,t){return Object(u.b)(this,void 0,void 0,regeneratorRuntime.mark((function r(){return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(r.t0=!1,!t){r.next=7;break}return r.next=4,Object(f.e)("\xbfDesbloquear?","Si desbloqueas el usuario seleccionado, se mostrar\xe1 en la lista y podr\xe1s hacer compras y ver toda la informaci\xf3n",500,"No, no desbloquear","Si, desbloquear");case 4:r.t1=r.sent,r.next=10;break;case 7:return r.next=9,Object(f.e)("\xbfBloquear?","Si bloqueas el usuario seleccionado, no se mostrar\xe1 en la lista",430,"No, no bloquear","Si, bloquear");case 9:r.t1=r.sent;case 10:if(r.t2=r.t1,r.t3=r.t0===r.t2,!r.t3){r.next=14;break}this.unblockUser(e.id,t,!0);case 14:case"end":return r.stop()}}),r,this)})))}},{key:"unblockUser",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];this.service.unblock(e,t,r).subscribe((function(e){console.log(e),e.status?Object(p.a)(b.a.SUCCESS,e.message):Object(p.a)(b.a.WARNING,e.message)}))}}]),e}(),a.\u0275fac=function(e){return new(e||a)(v.Mb(O))},a.\u0275cmp=v.Gb({type:a,selectors:[["app-users"]],decls:1,vars:7,consts:[[3,"query","context","itemsPage","resultData","include","tableColumns","filterActiveValues","manageItem"]],template:function(e,t){1&e&&(v.Rb(0,"app-table-pagination",0),v.dc("manageItem",(function(e){return t.takeAction(e)})),v.Qb()),2&e&&v.lc("query",t.query)("context",t.context)("itemsPage",t.itemsPage)("resultData",t.resultData)("include",t.include)("tableColumns",t.columns)("filterActiveValues",t.filterActiveValues)},directives:[C.a],styles:[""]}),a)}],w=((i=function e(){_classCallCheck(this,e)}).\u0275mod=v.Kb({type:i}),i.\u0275inj=v.Jb({factory:function(e){return new(e||i)},imports:[[c.e.forChild(_)],c.e]}),i),j=r("OwPx"),S=((o=function e(){_classCallCheck(this,e)}).\u0275mod=v.Kb({type:o}),o.\u0275inj=v.Jb({factory:function(e){return new(e||o)},imports:[[s.c,w,j.a]]}),o)}}]);