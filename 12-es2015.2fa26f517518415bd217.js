(window.webpackJsonp=window.webpackJsonp||[]).push([[12],{gAmC:function(e,t,s){"use strict";s.r(t),s.d(t,"UsersModule",(function(){return A}));var a=s("ofXK"),i=s("tyNb"),r=s("mrSG"),o=s("ODCe"),n=s("b1el"),l=s("0iDv"),c=s("sYSY"),u=s("PjjI"),d=s("fXoL"),b=s("0nJ8"),m=s("UdEE"),p=s("q3Kh"),v=s("vqVJ"),f=s("/IUn");let h=(()=>{class e extends b.a{constructor(e,t){super(t),this.usersService=e}register(e){return this.usersService.register(e)}update(e){return this.set(m.e,{user:e,include:!1}).pipe(Object(p.map)(e=>e.updateUser))}unblock(e,t=!1,s=!1){return this.set(m.c,{id:e,unblock:t,admin:s}).pipe(Object(p.map)(e=>e.blockUser))}sendEmailActive(e,t){return this.set(m.a,{id:e,email:t}).pipe(Object(p.map)(e=>e.activeUserEmail))}}return e.\u0275fac=function(t){return new(t||e)(d.Zb(v.a),d.Zb(f.a))},e.\u0275prov=d.Ib({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var y=s("hrBI");const j=[{path:"",component:(()=>{class e{constructor(e){this.service=e,this.query=o.c,this.filterActiveValues=u.a.ACTIVE}ngOnInit(){this.context={},this.itemsPage=10,this.resultData={listKey:"users",definitionKey:"users"},this.include=!0,this.columns=[{property:"id",label:"#"},{property:"name",label:"Nombre"},{property:"lastname",label:"Apellidos"},{property:"email",label:"Correo electr\xf3nico"},{property:"role",label:"Permisos"},{property:"active",label:"\xbfActivo?"}]}initializeForm(e){const t=void 0!==e.name&&""!==e.name?e.name:"",s=void 0!==e.lastname&&""!==e.lastname?e.lastname:"",a=void 0!==e.email&&""!==e.email?e.email:"",i=new Array(2);return i[0]=void 0!==e.role&&"ADMIN"===e.role?"selected":"",i[1]=void 0!==e.role&&"CLIENT"===e.role?"selected":"",`\n      <input id="name" value="${t}" class="swal2-input" placeholder="Nombre" required>\n      <input id="lastname" value="${s}" class="swal2-input" placeholder="Apellidos" required>\n      <input id="email" value="${a}" class="swal2-input" placeholder="Correo Electr\xf3nico" required>\n      <select id="role" class="swal2-input">\n        <option value="ADMIN" ${i[0]}>Administrador</option>\n        <option value="CLIENT" ${i[1]}>Cliente</option>\n      </select>\n    `}takeAction(e){return Object(r.b)(this,void 0,void 0,(function*(){const t=e[0],s=e[1],a=this.initializeForm(s);switch(t){case"add":this.addForm(a);break;case"edit":this.updateForm(a,s);break;case"info":const e=yield Object(n.e)("Detalles",`${s.name} ${s.lastname}<br/>\n          <i class="fas fa-envelope-open-text"></i>&nbsp;&nbsp;${s.email}`,!1!==s.active?375:400,'<i class="fas fa-edit"></i> Editar',!1!==s.active?'<i class="fas fa-lock"></i> Bloquear':'<i class="fas fa-lock-open"></i> Desbloquear');e?this.updateForm(a,s):!1===e&&this.unblockForm(s,!1===s.active);break;case"block":this.unblockForm(s,!1);break;case"unblock":this.unblockForm(s,!0)}}))}addForm(e){return Object(r.b)(this,void 0,void 0,(function*(){const t=yield Object(n.f)("A\xf1adir usuario",e);this.addUser(t)}))}addUser(e){if(e.value){const t=e.value;t.password="1234",t.active=!1,this.service.register(t).subscribe(e=>{if(e.status)return Object(l.a)(c.a.SUCCESS,e.message),void this.service.sendEmailActive(e.user.id,t.email).subscribe(e=>{e.status?Object(l.a)(c.a.SUCCESS,e.message):Object(l.a)(c.a.WARNING,e.message)});Object(l.a)(c.a.WARNING,e.message)})}}updateForm(e,t){return Object(r.b)(this,void 0,void 0,(function*(){const s=yield Object(n.f)("Modificar usuario",e);this.updateUser(s,t.id)}))}updateUser(e,t){e.value&&(e.value.id=t,this.service.update(e.value).subscribe(e=>{e.status?Object(l.a)(c.a.SUCCESS,e.message):Object(l.a)(c.a.WARNING,e.message)}))}unblockForm(e,t){return Object(r.b)(this,void 0,void 0,(function*(){!1===(t?yield Object(n.e)("\xbfDesbloquear?","Si desbloqueas el usuario seleccionado, se mostrar\xe1 en la lista y podr\xe1s hacer compras y ver toda la informaci\xf3n",500,"No, no desbloquear","Si, desbloquear"):yield Object(n.e)("\xbfBloquear?","Si bloqueas el usuario seleccionado, no se mostrar\xe1 en la lista",430,"No, no bloquear","Si, bloquear"))&&this.unblockUser(e.id,t,!0)}))}unblockUser(e,t=!1,s=!1){this.service.unblock(e,t,s).subscribe(e=>{console.log(e),e.status?Object(l.a)(c.a.SUCCESS,e.message):Object(l.a)(c.a.WARNING,e.message)})}}return e.\u0275fac=function(t){return new(t||e)(d.Mb(h))},e.\u0275cmp=d.Gb({type:e,selectors:[["app-users"]],decls:1,vars:7,consts:[[3,"query","context","itemsPage","resultData","include","tableColumns","filterActiveValues","manageItem"]],template:function(e,t){1&e&&(d.Rb(0,"app-table-pagination",0),d.dc("manageItem",(function(e){return t.takeAction(e)})),d.Qb()),2&e&&d.lc("query",t.query)("context",t.context)("itemsPage",t.itemsPage)("resultData",t.resultData)("include",t.include)("tableColumns",t.columns)("filterActiveValues",t.filterActiveValues)},directives:[y.a],styles:[""]}),e})()}];let k=(()=>{class e{}return e.\u0275mod=d.Kb({type:e}),e.\u0275inj=d.Jb({factory:function(t){return new(t||e)},imports:[[i.e.forChild(j)],i.e]}),e})();var O=s("OwPx");let A=(()=>{class e{}return e.\u0275mod=d.Kb({type:e}),e.\u0275inj=d.Jb({factory:function(t){return new(t||e)},imports:[[a.c,k,O.a]]}),e})()}}]);